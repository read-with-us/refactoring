# 6장 기본적인 리팩터링 (1)

> **Note**
>
> '기본적인 리팩터링' 챕터는 다음 질문을 중심으로 읽어나가시면 좋습니다.
>
> 1. 해당 리팩터링 기법이 왜 필요한가
> 2. 해당 리팩터링 기법을 언제 적용해야 하는가
> 3. 해당 리팩터링 기법은 어떤 효과가 있는가
>
> 프로그래밍의 기본 요소인 변수와 함수를 중심으로 살펴보세요.

p.157
> 1. 추출은 결국 이름 짓기이며, 코드 이해도가 높아지다 보면 이름을 바꿔야 할 때가 많다.

## 6-1 함수 추출하기
p. 159
> 1. 목적과 구현을 분리하는 방식이 가장 합리적인 기준으로 보인다. 코드를 보고 무슨 일을 하는지 파악하는데 한참이 걸린다면 그 부분을 함수로 추출한 뒤 ‘무슨 일’에 걸맞는 이름을 짓는다. 
> 2. 함수를 짧게 만들면 함수 호출이 많아져서 성능이 느려질까 걱정하는 사람도 있다. 내가 젊던 시절에는 간혹 문제가 되긴 했지만 요즘은 그럴 일이 거의 없다. 함수가 짧으면 캐싱하기가 더 쉽기 때문에 컴파일러가 최적화하는 데 유리할 때가 많다.
> 3. “최적화를 할 때는 다음 두 규칙을 따르기 바란다. 첫 번째, 하지마라. 두 번째(전문가 한정), 아직 하지 마라” - M.A. 잭슨
p.160
> 1. 짧은 함수의 이점은 이름을 잘 지어야만 발휘되므로 이름 짓기에 특별히 신경 써야 한다.
💡의견
> 1. 성능 최적화 경험 공유
> - 코드 스플리팅을 이용한 진입점 제어
> 2. React를 쓰면서 평소에 함수 추출을 해뒀더니, 파일 구조를 바꿀 때 너무 좋았던 경험이 있었음. 

## 6.2 함수 인라인하기
> p.169
> 1. 함수 본문이 이름만큼 명확한 경우도 있다. 또는 함수 본문 코드를 이름만큼 깔끔하게 리팩터링할 때도 있다.
> 2. 간접호출을 너무 과하게 쓰는 코드도 흔한 인라인 대상이다.

## 6.3 변수 추출하기
> p.173
> 1.  표현식이 너무 복잡해서 이해하기 어려울 때가 있다. 이럴 때 지역 변수를 활용하면 표현식을 쪼개 관리하기 더 쉽게 만들 수 있다. 그러면 복잡한 로직을 구성하는 단계마다 이름을 붙일 수 있어서 코드의 목적을 훨씬 명확하게 드러낼 수 있다.
> 2. 이 과정에서 추가한 변수는 디버깅에도 도움된다. 디버거에 중단점을 지정하거나 상태를 출력하는 문장을 추가할 수 있기 떄문이다.
> 3. 변수 추출을 고려한다고 함은 표현식에 이름을 붙이고 싶다는 뜻이다.
> 4. 현재 함수 안에서만 의미가 있다면 변수로 추출하는 것이 좋다. 그러나 함수를 벗어난 넓은 문맥에서까지 의미가 된다면 그 넓은 범위에서 통용되는 이름을 생각해야 한다. 다시 말해 변수가 아닌(주로) 함수를 추출해야 한다.
p.177
> 여기서 객체의 엄청난 장점을 볼 수 있다. 객체는 특정 로직과 데이터를 외부와 공유하려 할 때 공유할 정보를 설명해주는 적당한 크기의 문맥이 되어준다. 이 예처럼 간단한 경우라면 효과가 크지 않지만, 덩치가 큰 클래스에서 공통 동작을 별도 이름으로 뽑아내서 추상화해두면 그 객체를 다룰 때 쉽게 활용할 수 있어서 매우 유용하다.

## 6.4 변수 인라인하기
p.178
> 1. 하지만 그 이름이 원래 표현식과 다를 바 없을 때도 있다. 또 변수가 주변 코드를 리팩터링하는 데 방해가 되기도 한다. 이럴 때는 그 변수를 인라인하는 것이 좋다.

## 6.5 함수 선언 바꾸기
p.179
> 1. 함수 선언은 각 부분이 서로 맞물리는 방식을 표현하며, 실질적으로 소프트웨어 시스템의 구성 요소를 조립하는 연결부 역할을 한다.
> 2. 연결부를 잘 정의하면 시스템에 새로운 부분을 추가하기가 쉬워지는 반면, 잘못 정의하면 지속적은 방해 요인으로 작용하여 소프트웨어 동작을 파악하기 어려워지고 요구사항이 바뀔 때 적절히 수정하기 어렵게 한다.
> 3. 이러한 연결부에서 가장 중요한 요소는 함수의 이름이다. 이름이 좋으면 함수의 구현 코드를 살펴볼 필요 없이 호출문만 보고도 무슨 일을 하는지 파악할 수 있다.
> 4. 그래서 나는 이름이 잘못된 함수를 발견하면 더 나은 이름이 떠오르는 즉시 바꾸라는 명령으로 받아들인다. 그래야 나중에 그 코드를 다시 볼 때 무슨일 을 하는지 ‘또’ 고민하지 않게 된다.
p.180
> 1. 좋은 이름을 떠올리는 데 효과적인 방법이 하나있다. 바로 주석을 이용해 함수의 목적을 설명해보는 것이다. 그러다 보면 주석이 멋진 이름으로 바뀌어 되돌아올 때가 있다.
> 2. 매개변수는 함수가 외부 세계와 어우러지는 방식을 정의한다. 매개변수는 함수를 사용하는 문맥을 설정한다.
> 3. 이렇게 하면 활용 범위가 넓어질 뿐만 아니라, 다른 모듈과의 결합을 제거할 수도 있다. 예컨데 전화번호 포매팅 로직을 사람 관련 정보를 전혀 모르는 모듈에 둘 수 있다.
p.182
> 1. 공개된 API를 리팩터링할 때는 새 함수를 추가한 다음 리팩터링을 잠시 멈출 수 있다.
p.185
> 1. 나는 자바스크립트로 프로그래밍한다면 호출문을 변경하기 전에 어셔션을 추가하여 호출하는 곳에서 새로 추가한 매개변수를 실제로 사용하는지 확인한다.
P.187
> 1. 자동 리팩터링 도구는 마이그레이션 절차의 활용도를 떨어뜨리기도 하고 효과를 배가하기도 한다.

## 6.6 변수 캡슐화하기
p.188
> 1. 함수는 데이터보다 다루기가 수월하다. 함수를 사용한다는 건 대체로 호출한다는 뜻이고, 함수의 이름을 바꾸거나 다른 모듈로 옮기기는 어렵지 않다. 여차하면 기존 함수를 그대로 둔채 전달 함수로 활용할 수도 있기 때문이다.
> 2. 데이터는 참조하는 모든 부분을 한 번에 바꿔야 코드가 제대로 작동한다. 짧은 함수 안의 임시 변수처럼 유효번위가 아주 좁은 데이터는 어려울 게 없지만, 유효범위가 넓어질 수록 다루기 어려워진다.
> 3. 그래서 접근할 수 있는 범위가 넓은 데이터를 옮길 때는 먼저 그 데이터로의 접근을 독점하는 함수를 만드는 식으로 캡슐화하는 것이 가장 좋은 방법일 때가 많다.
p.189
> 1. 불변 데이터는 가변 데이터보다 캡슐화할 이유가 적다.
> 2. 불변 데이터는 옮길 필요없이 그냥 복제하면 된다. 그래서 원본 데이터를 참조하는 코드를 변경할 필요도 없고, 데이터를 변형시키는 코드를 걱정할 일도 없다. 불변성은 강력한 방부제인 셈이다.
💡의견
> 1. JS/TS에서 프라이빗 변수로 선언하는 방법
> - JS/TS 둘 다 ‘#’을 붙이면 되고, TS에서는 private 키워드도 사용 가능함. 

## 6.7 변수 이름 바꾸기
p.194
> 1. 사실 나는 이름을 잘못 지을 때가 많다. 고민을 충분히 하지 않아서거나, 개발을 더 하나 보니 문제에 대한 이해도가 높아져서거나, 혹은 사용자의 요구가 달라져서 프로그램의 목적이 변해 그럴 때도 있다.